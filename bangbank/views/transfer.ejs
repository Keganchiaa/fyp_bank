<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Transfer - BangBank</title>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>

    <div class="container">

        <h2 class="section-header">Transfer Funds</h2>

        <% if (error) { %>
            <div class="error-message">
                <%= error %>
            </div>
            <% } %>

                <% if (userAccounts.length===0) { %>
                    <div class="empty-state">
                        <h2>No Accounts Found</h2>
                        <p>You need at least one active savings account to initiate a transfer.</p>
                    </div>
                    <% } else { %>
                        <form method="POST" onsubmit="this.action = '/account/transfer/' + this.from_account_id.value;">
                            <label for="from_account_id">From Account:</label>
                            <select name="from_account_id" required>
                                <% userAccounts.forEach(acc=> { %>
                                    <option value="<%= acc.account_id %>">
                                        <%= acc.product_name %> - $<%= parseFloat(acc.balance).toFixed(2) %>
                                    </option>
                                    <% }) %>
                            </select>

                            <label for="to_account_id">To Account (User - Type):</label>
                            <select name="to_account_id" required>
                                <% allUsers.forEach(user=> { %>
                                    <optgroup label="<%= user.username %>">
                                        <% user.accounts.forEach(a=> { %>
                                            <option value="<%= a.account_id %>">
                                                <%= a.product_name %> ($<%= parseFloat(a.balance).toFixed(2) %>)
                                            </option>
                                            <% }) %>
                                    </optgroup>
                                    <% }) %>
                            </select>

                            <label for="amount">Amount:</label>
                            <input type="number" name="amount" step="0.01" required>

                            <button type="submit" class="btn btn-primary">Transfer</button>
                        </form>
                        <% } %>
    </div>
</body>

</html>